{# 
# @file templates/newsletter.html.twig 
# @brief Template pour la page de la Newsletter
#}
{% extends 'base_template.html.twig' %}
{% block stylesheets %}
	{{ parent() }}
	<link rel="stylesheet" href="/assets/css/newsletter.css">
{% endblock %}
{% block content %}
	<div class="container py-5">
		<form action="/?controller=home&method=ajouterGenerales" method="post" class="form-newsletter">
			<h2>Tenez vous √† l'√©coute !</h2>
			<p>Recevez les derni√®res actualit√©s de Paaxio directement dans votre bo√Æte mail.
			</p>
			{% if success %}
				<div class="alert alert-success" role="alert">
					{{ success }}
				</div>
				<div id="music-rain"></div>
			{% endif %}
			{% if errors is defined and errors|length > 0 %}
				<div class="alert alert-danger" role="alert">
					<ul class="mb-0">
						{% for error in errors %}
							<li>{{ error }}</li>
						{% endfor %}
					</ul>
				</div>
			{% endif %}
			<label for="email">Adresse e-mail:
			</label>
			<input type="email" id="email" name="email" required placeholder="Votre adresse e-mail" value="{{ form.email|default('') }}">

			<div class="form-check my-3">
				<input class="form-check-input" type="checkbox" id="consent_newsletter" name="consent_newsletter" required>
				<label class="form-check-label" for="consent_newsletter">
					J'accepte de m'abonner √† la newsletter pour recevoir les derni√®res actualit√©s par courriel et j'accepte les termes et conditions. <a href="/?controller=conditionsGenerales&method=afficher">Voir la politique de confidentialit√©</a>
				</label>
			</div>

			<button type="submit">S'abonner</button>
		</form>
	</div>

	{% if success %}
	<script>
	document.addEventListener("DOMContentLoaded", () => {
		const container = document.getElementById("music-rain");
		if (!container) return;

		const notes = ["üéµ", "üé∂", "üéº", "üéß", "üéπ"];
		let rainInterval;

		function createNote() {
			const note = document.createElement("div");
			note.classList.add("music-note");
			note.textContent = notes[Math.floor(Math.random() * notes.length)];

			note.style.left = Math.random() * 100 + "vw";
			note.style.fontSize = 14 + Math.random() * 30 + "px";
			note.style.animationDuration = 3 + Math.random() * 3 + "s";

			container.appendChild(note);

			setTimeout(() => note.remove(), 7000);
		}

		// Lance la pluie (1 note toutes les 100ms)
		rainInterval = setInterval(createNote, 100);

		// Stop la pluie apr√®s 5 secondes
		setTimeout(() => {
			clearInterval(rainInterval);
		}, 5000);
	});
	</script>
	{% endif %}
{% endblock %}
