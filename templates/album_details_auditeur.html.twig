{% extends "base_template.html.twig" %}

{% block header %}
	{{ parent() }}
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
	<style>
		body {
			font-family: 'Inter', sans-serif;
			background-color: #f0f0f0;
		}
		.content-bg {
			background: linear-gradient(135deg, #a36666 0%, #d4a373 100%);
		}
		.track-row:nth-child(even) {
			background-color: rgba(0, 0, 0, 0.05);
		}
		.table {
			--bs-table-bg: transparent;
			--bs-table-border-color: rgba(0, 0, 0, 0.1);
			--bs-table-color: var(--bs-white);
			--bs-table-hover-color: var(--bs-white);
		}
		.table-hover > tbody > tr:hover > * {
			--bs-table-hover-bg: rgba(0, 0, 0, 0.15);
		}
	</style>
{% endblock %}

{% block content %}
	{% set totalDuration = 0 %}
	{% for chanson in chansons %}
		{% set totalDuration = totalDuration + chanson.getDureeChanson() %}
	{% endfor %}
	{% set totalMinutes = (totalDuration / 60)|round(0, 'floor') %}
	{% set totalSeconds = totalDuration % 60 %}

	<main class="container my-4 my-lg-5">
		<div class="content-bg rounded-3 shadow-lg p-3 p-lg-5 text-white">

			<div class="d-flex flex-column flex-md-row align-items-start gap-4">
				<div class="flex-shrink-0">
					<img src="{{ album.getUrlImageAlbum() ?: 'https://placehold.co/160x160/7b4343/ffffff?text=' ~ (album.getTitreAlbum()|replace({' ': '+'})|slice(0, 20)) }}" alt="Couverture de l'album {{ album.getTitreAlbum() }}" class="rounded-2 shadow-lg" style="width: 160px; height: 160px; object-fit: cover;">
				</div>

				<div class="flex-grow-1">
					<span class="text-sm fw-light text-uppercase" style="letter-spacing: 0.1em; opacity: 0.8;">Album</span>
					<h2 class="display-4 fw-bolder mt-1 mb-2">{{ album.getTitreAlbum() }}</h2>
					<p class="fs-5 fw-light" style="opacity: 0.9;">
						{{ album.getArtisteAlbum() }}
						{% if album.getDateSortieAlbum() %}
							·
							{{ album.getDateSortieAlbum()|date('Y') }}
						{% endif %}
						·
						{{ chansons|length }}
						titre{{ chansons|length > 1 ? 's' : '' }},
						{{ totalMinutes }}
						min
						{{ totalSeconds|number_format(0, '', '02') }}
						s
					</p>

					<div class="mt-3">
						<button type="button" class="btn btn-light text-dark fw-semibold py-2 px-4 rounded-pill shadow-lg">
							<i class="bi bi-heart-fill"></i> Aimer l'album
						</button>
					</div>
				</div>
			</div>

			<div class="mt-5 overflow-x-auto">
				<table class="table table-hover align-middle">
					<thead style="background-color: rgba(0,0,0,0.2);">
						<tr class="text-sm text-uppercase fw-semibold" style="color: rgba(255,255,255,0.9); letter-spacing: 0.05em;">
							<th scope="col" class="py-3 px-4" style="width: 5%;">#</th>
							<th scope="col" class="py-3 px-4" style="width: 55%;">Titre</th>
							<th scope="col" class="py-3 px-4 d-none d-sm-table-cell" style="width: 20%;">Nombre d'écoutes</th>
							<th scope="col" class="py-3 px-4" style="width: 10%;">Durée</th>
							<th scope="col" class="py-3 px-4" style="width: 10%;"></th>
						</tr>
					</thead>
					<tbody>
						{% if chansons is not empty %}
							{% for chanson in chansons %}
								<tr class="track-row" style="color: rgba(255,255,255,0.9);">
									<td class="py-3 px-4 fw-bold">{{ loop.index|number_format(2, '.', ',') }}</td>
									<td class="py-3 px-4">{{ chanson.getTitreChanson() }}</td>
									<td class="py-3 px-4 d-none d-sm-table-cell">0</td>
									<td class="py-3 px-4">{{ (chanson.getDureeChanson() / 60)|round(0, 'floor') }}:{{ (chanson.getDureeChanson() % 60)|number_format(0, '', '02') }}</td>
									<td class="py-3 px-4 text-center">
										<button title="Lire la musique" class="btn btn-sm btn-link p-1">
											<i class="bi bi-play-fill" style="color: rgba(255,255,255,0.7); font-size: 1.2rem;"></i>
										</button>
										<button title="Aimer la musique" class="btn btn-sm btn-link p-1">
											<i class="bi bi-heart" style="color: rgba(255,255,255,0.7); font-size: 1rem;"></i>
										</button>
									</td>
								</tr>
							{% endfor %}
						{% else %}
							<tr>
								<td colspan="5" class="text-center py-4" style="opacity: 0.8;">Cet album ne contient aucune chanson pour le moment.</td>
							</tr>
						{% endif %}
					</tbody>
				</table>
			</div>
		</div>
	</main>

{% endblock %}
{% block script %}
{% endblock %}